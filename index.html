<script>
    function printReceipt(key) {
        const item = localData.donations[key];
        
        // Donation Receipt ka Professional Design
        document.getElementById('printArea').innerHTML = `
            <div style="padding:30px; background:white; position:relative; overflow:hidden; min-height:500px; color:#000;">
                
                <div style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%) rotate(-30deg); font-size:60px; color:rgba(0,0,0,0.05); font-weight:900; z-index:0; white-space:nowrap; pointer-events:none;">
                    B.B.C MARANG BUNDU <br> OFFICIAL RECEIPT
                </div>

                <div style="position:relative; z-index:1;">
                    <center>
                        <h1 class="print-h1" style="font-size:35px; color:#000;">52nd SAHID DIWAS 2026</h1>
                        <h2 class="print-h2" style="font-size:28px; letter-spacing:2px;">B.B.C MARANG BUNDU</h2>
                        <div style="font-weight:bold; font-size:14px; margin-bottom:5px;">REGD. UNDER SOCIETIES ACT: MBJ8750-13 OF 2022</div>
                        <div style="font-size:13px; margin-bottom:10px;">At/Po: Marang Bundu, Dist: Mayurbhanj, Odisha</div>
                        <div class="label-pill" style="font-size:18px; border:2px solid #000;">OFFICIAL DONATION RECEIPT</div>
                    </center>

                    <div style="display:flex; justify-content:space-between; margin-top:30px; font-size:17px; font-weight:600;">
                        <span>Receipt No: <span style="border-bottom:1px solid #000;">#BBC/${new Date().getFullYear()}/${key.substr(-4).toUpperCase()}</span></span>
                        <span>Date: <span style="border-bottom:1px solid #000;">${item.date}</span></span>
                    </div>

                    <div style="font-size:19px; line-height:2.2; margin-top:30px; font-family:'Crimson Text', serif;">
                        Received with thanks from Mr./Ms./M/s. <b style="border-bottom:1.5px solid #000; padding:0 10px; min-width:350px; display:inline-block;">${item.name}</b> <br>
                        The sum of Rupees <b style="border-bottom:1.5px dotted #000; text-transform:capitalize; padding:0 5px;">${numToWords(item.amt)}</b> <br>
                        By <span style="border:1px solid #000; padding:2px 10px;">☑ Cash / Online</span> towards <b style="border-bottom:1.5px dotted #000;">52nd Sahid Diwas Celebration Fund</b>.
                    </div>

                    <center>
                        <div style="margin:40px 0;">
                            <span style="font-size:20px; font-weight:bold; margin-right:10px;">AMOUNT:</span>
                            <div style="border:5px double #000; padding:15px 60px; font-size:35px; font-weight:900; background:#f9f9f9 !important; display:inline-block; -webkit-print-color-adjust: exact;">
                                ₹ ${Number(item.amt).toLocaleString()}/-
                            </div>
                        </div>
                    </center>

                    <div style="margin-top:20px; font-size:13px; line-height:1.4; font-style:italic; color:#333; text-align:center; padding:0 50px;">
                        "Aapke is sahyog ke liye samiti hamesha aapki aabhari rahegi. Ye rashi samajik aur sanskritik karyo mein upyog ki jayegi."
                    </div>

                    <div style="display:flex; justify-content:space-between; align-items:flex-end; margin-top:70px; padding:0 20px;">
                        <div style="text-align:center;">
                            <div style="width:120px; height:120px; border:2px dashed #ccc; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:10px; color:#999; margin-bottom:5px;">OFFICIAL SEAL</div>
                            <div style="font-weight:bold; font-size:14px; border-top:1.5px solid #000; padding-top:5px; width:150px;">Donor Signature</div>
                        </div>
                        <div style="text-align:center;">
                            <span class="sig-font" style="color:blue;">${localData.config.tName}</span>
                            <div style="font-weight:bold; font-size:14px; border-top:1.5px solid #000; padding-top:5px; width:220px;">Authorized Signatory (Treasurer)</div>
                            <div style="font-size:11px; margin-top:5px;">B.B.C Marang Bundu</div>
                        </div>
                    </div>

                    <div style="margin-top:50px; border-top:1px dashed #ccc; padding-top:10px; text-align:center; font-size:10px; color:#666;">
                        * This is a computer generated receipt. Donation is non-refundable. Thank you for your support! *
                    </div>
                </div>
            </div>`;
        
        window.print();
    }
</script>
