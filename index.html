<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TREASURE BOOKS ELITE | BBC MARANG BUNDU</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&family=Outfit:wght@300;400;600;900&family=Dancing+Script:wght@700&family=Crimson+Text:ital,wght@1,600&display=swap');

        :root {
            --bg: #f8fafc; --gold: #b45309; --green: #047857; --red: #be123c; --border: #e2e8f0; --text: #1e293b;
        }

        body { 
            margin: 0; font-family: 'Outfit', sans-serif; 
            background: linear-gradient(135deg, #f1f5f9 0%, #ffffff 100%);
            color: var(--text); min-height: 100vh; 
        }

        /* Dashboard UI Elements */
        .year-floating-box {
            position: fixed; top: 20px; right: 20px; z-index: 1000;
            background: #fff; border: 2.5px solid var(--gold);
            padding: 8px 15px; border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            display: flex; align-items: center; gap: 8px;
        }
        .year-floating-box select { border: none; outline: none; font-weight: 900; color: var(--gold); cursor: pointer; background: transparent; font-size: 15px; }

        .dash-header { text-align: center; padding: 60px 20px 10px; }
        .main-title { font-family: 'Cinzel', serif; font-size: clamp(32px, 8vw, 52px); font-weight: 900; letter-spacing: 5px; margin: 0; }
        .sub-header { color: var(--gold); font-weight: 700; letter-spacing: 2px; }
        .reg-no { font-size: 13px; font-weight: 600; opacity: 0.7; }

        .treasurer-config { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin: 20px auto; }
        .t-box { background: #fff; border: 1px solid var(--border); padding: 12px; border-radius: 15px; flex: 1; min-width: 200px; max-width: 250px; box-shadow: 0 4px 10px rgba(0,0,0,0.03); }
        .t-box label { font-size: 10px; color: var(--gold); text-transform: uppercase; display: block; font-weight: 900; }
        .t-box input { background: transparent; border: none; border-bottom: 1.5px solid var(--gold); color: var(--text); text-align: center; font-weight: 900; width: 100%; outline: none; }

        .stats-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; max-width: 1100px; margin: 30px auto; width: 95%; }
        .stat-card { background: #fff; padding: 25px; border-radius: 28px; border: 1px solid var(--border); text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .stat-val { font-size: 32px; font-weight: 900; font-family: 'Cinzel'; margin-top: 5px; }

        .form-box { background: #fff; padding: 30px; border-radius: 35px; border: 1px solid var(--border); max-width: 850px; margin: 30px auto; width: 90%; box-shadow: 0 15px 40px rgba(0,0,0,0.08); }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .form-grid input, .form-grid select { background: #f8fafc; border: 1px solid var(--border); padding: 14px; border-radius: 14px; outline: none; }
        .btn-save { grid-column: 1 / -1; background: #1e293b; color: #fff; border: none; padding: 18px; border-radius: 15px; font-weight: 900; cursor: pointer; text-transform: uppercase; letter-spacing: 2px; }

        .lists-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 25px; max-width: 1400px; margin: 40px auto; padding: 0 20px; }
        .ledger-box { background: #fff; padding: 20px; border-radius: 25px; border: 1px solid var(--border); box-shadow: 0 10px 30px rgba(0,0,0,0.05); overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 14px; }
        th { text-align: left; color: var(--gold); padding: 12px; border-bottom: 2px solid #f1f5f9; }
        td { padding: 12px; border-bottom: 1px solid #f8fafc; }
        .btn-mini { padding: 6px 12px; border-radius: 8px; cursor: pointer; border: 1px solid #e2e8f0; background: #fff; font-size: 11px; margin: 2px; }

        .modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); z-index: 2000; align-items:center; justify-content:center; backdrop-filter: blur(4px); }
        .modal-content { background:#fff; padding:30px; border-radius:25px; border: 2px solid var(--gold); width:350px; }

        #printArea { display: none; }
        @media print {
            body * { visibility: hidden; }
            #printArea, #printArea * { visibility: visible; }
            #printArea { display: block !important; position: absolute; left: 0; top: 0; width: 100%; }
        }
    </style>
</head>
<body>

<div class="year-floating-box no-print">
    <span style="font-size:11px; font-weight:900;">SESSION:</span>
    <select id="yearFilter" onchange="loadView()"></select>
</div>

<div class="dash-header no-print">
    <h1 class="main-title">TREASURE BOOKS</h1>
    <div class="sub-header">B.B.C MARANG BUNDU</div>
    <div class="reg-no">Reg.no :- MBJ8750 - 13 Of 2022</div>
</div>

<div class="treasurer-config no-print">
    <div class="t-box"><label>Principal Treasurer</label><input type="text" id="cfgT" placeholder="Name" onchange="updateCfg()"></div>
    <div class="t-box"><label>Assistant Treasurer</label><input type="text" id="cfgAT" placeholder="Name" onchange="updateCfg()"></div>
</div>

<div class="stats-container no-print">
    <div class="stat-card"><div style="color:var(--green); font-weight:900; font-size:12px;">COLLECTIONS</div><div class="stat-val" id="sumIn" style="color:var(--green)">‚Çπ 0</div></div>
    <div class="stat-card"><div style="color:var(--red); font-weight:900; font-size:12px;">EXPENDITURES</div><div class="stat-val" id="sumOut" style="color:var(--red)">‚Çπ 0</div></div>
    <div class="stat-card"><div style="color:var(--gold); font-weight:900; font-size:12px;">BALANCE</div><div class="stat-val" id="sumBal" style="color:var(--gold)">‚Çπ 0</div></div>
</div>

<div class="form-box no-print">
    <div class="form-grid">
        <select id="eType" style="grid-column: 1 / -1; font-weight: bold;"><option value="donation">‚ú® CREDIT (Collection)</option><option value="expense">üõ°Ô∏è DEBIT (Expenditure)</option></select>
        <input type="date" id="eDate">
        <input type="number" id="eAmount" placeholder="Amount ‚Çπ">
        <input type="text" id="eName" placeholder="Name / Purpose">
        <button class="btn-save" onclick="saveEntry()">Save Transaction</button>
    </div>
</div>

<div class="lists-container no-print">
    <div class="ledger-box">
        <h3 style="color:var(--green); display:flex; justify-content:space-between; align-items:center;">Collections <button class="btn-mini" onclick="printReport('don')">Full Report</button></h3>
        <input type="text" id="searchDon" style="width:100%; padding:10px; margin-bottom:10px; border-radius:10px; border:1px solid #ddd;" placeholder="Search..." onkeyup="loadView()">
        <table><thead><tr><th>Date</th><th>Donor</th><th>Amount</th><th>Action</th></tr></thead><tbody id="bodyDon"></tbody></table>
    </div>
    <div class="ledger-box">
        <h3 style="color:var(--red); display:flex; justify-content:space-between; align-items:center;">Expenditures <button class="btn-mini" onclick="printReport('exp')">Full Report</button></h3>
        <input type="text" id="searchExp" style="width:100%; padding:10px; margin-bottom:10px; border-radius:10px; border:1px solid #ddd;" placeholder="Search..." onkeyup="loadView()">
        <table><thead><tr><th>Date</th><th>Purpose</th><th>Amount</th><th>Action</th></tr></thead><tbody id="bodyExp"></tbody></table>
    </div>
</div>

<div id="editModal" class="modal">
    <div class="modal-content">
        <h3 style="color:var(--gold); margin-top:0;">Edit Entry</h3>
        <input type="hidden" id="editKey"><input type="hidden" id="editType">
        <input type="date" id="mDate" style="width:100%; padding:10px; margin-bottom:10px;">
        <input type="text" id="mName" style="width:100%; padding:10px; margin-bottom:10px;">
        <input type="number" id="mAmount" style="width:100%; padding:10px; margin-bottom:15px;">
        <button class="btn-save" onclick="updateData()" style="width:100%;">Update</button>
        <button onclick="closeModal()" style="width:100%; background:none; border:none; color:gray; margin-top:10px;">Cancel</button>
    </div>
</div>

<div id="printArea"></div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyA_xB865cARTIZI5XFj7SMaA3c_xPfaDpc",
        authDomain: "treasure-books-a655d.firebaseapp.com",
        databaseURL: "https://treasure-books-a655d-default-rtdb.firebaseio.com",
        projectId: "treasure-books-a655d",
        storageBucket: "treasure-books-a655d.firebasestorage.app",
        messagingSenderId: "543411661924",
        appId: "1:543411661924:web:e87cdddfa8e839b47a8371"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let localData = { donations: {}, expenses: {}, config: { tName: "", atName: "" } };

    db.ref().on('value', snap => {
        const v = snap.val() || {};
        localData.donations = v.donations || {};
        localData.expenses = v.expenses || {};
        if(v.config) {
            localData.config = v.config;
            document.getElementById('cfgT').value = v.config.tName || "";
            document.getElementById('cfgAT').value = v.config.atName || "";
        }
        loadView();
    });

    function updateCfg() { db.ref('config').update({ tName: document.getElementById('cfgT').value, atName: document.getElementById('cfgAT').value }); }

    function numToWords(n) {
        const a = ['', 'One ', 'Two ', 'Three ', 'Four ', 'Five ', 'Six ', 'Seven ', 'Eight ', 'Nine ', 'Ten ', 'Eleven ', 'Twelve ', 'Thirteen ', 'Fourteen ', 'Fifteen ', 'Sixteen ', 'Seventeen ', 'Eighteen ', 'Nineteen '];
        const b = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];
        const format = (num) => {
            if (num == 0) return '';
            if (num < 20) return a[num];
            if (num < 100) return b[Math.floor(num / 10)] + (num % 10 !== 0 ? ' ' + a[num % 10] : '');
            if (num < 1000) return a[Math.floor(num / 100)] + ' Hundred ' + (num % 100 !== 0 ? 'and ' + format(num % 100) : '');
            if (num < 100000) return format(Math.floor(num / 1000)) + ' Thousand ' + (num % 1000 !== 0 ? format(num % 1000) : '');
            if (num < 10000000) return format(Math.floor(num / 100000)) + ' Lakh ' + (num % 100000 !== 0 ? format(num % 100000) : '');
            return format(Math.floor(num / 10000000)) + ' Crore ' + (num % 10000000 !== 0 ? format(num % 10000000) : '');
        }
        return n == 0 ? 'Zero Only' : format(n) + 'Only';
    }

    function loadView() {
        const fy = document.getElementById('yearFilter').value;
        const bD = document.getElementById('bodyDon'), bE = document.getElementById('bodyExp');
        const sD = document.getElementById('searchDon').value.toLowerCase();
        const sE = document.getElementById('searchExp').value.toLowerCase();
        let tin = 0, tout = 0; bD.innerHTML = ''; bE.innerHTML = '';
        Object.entries(localData.donations).filter(([_, x]) => x.year == fy && x.name.toLowerCase().includes(sD)).sort((a,b)=>new Date(b[1].date)-new Date(a[1].date)).forEach(([k, x]) => {
            tin += Number(x.amt);
            bD.innerHTML += `<tr><td>${x.date}</td><td>${x.name}</td><td>‚Çπ${Number(x.amt).toLocaleString()}</td><td>
                <button class="btn-mini" onclick="printReceipt('${k}')">Bill</button> 
                <button class="btn-mini" style="background:#fff8e1; border-color:#b45309;" onclick="printCertificate('${k}')">üìú Cert</button>
                <button class="btn-mini" onclick="openEditModal('donation','${k}')">‚úèÔ∏è</button> 
                <button class="btn-mini" onclick="deleteEntry('donations','${k}')">üóëÔ∏è</button></td></tr>`;
        });
        Object.entries(localData.expenses).filter(([_, x]) => x.year == fy && x.name.toLowerCase().includes(sE)).sort((a,b)=>new Date(b[1].date)-new Date(a[1].date)).forEach(([k, x]) => {
            tout += Number(x.amt);
            bE.innerHTML += `<tr><td>${x.date}</td><td>${x.name}</td><td>‚Çπ${Number(x.amt).toLocaleString()}</td><td><button class="btn-mini" onclick="openEditModal('expense','${k}')">‚úèÔ∏è</button> <button class="btn-mini" onclick="deleteEntry('expenses','${k}')">üóëÔ∏è</button></td></tr>`;
        });
        document.getElementById('sumIn').innerText = '‚Çπ ' + tin.toLocaleString();
        document.getElementById('sumOut').innerText = '‚Çπ ' + tout.toLocaleString();
        document.getElementById('sumBal').innerText = '‚Çπ ' + (tin - tout).toLocaleString();
    }

    function saveEntry() {
        const t = document.getElementById('eType').value, d = document.getElementById('eDate').value, n = document.getElementById('eName').value, a = document.getElementById('eAmount').value;
        if(!d || !n || !a) return alert("Fill data!");
        db.ref(t === 'donation' ? 'donations/' : 'expenses/').push({ date: d, name: n, amt: Number(a), year: new Date(d).getFullYear() });
        document.getElementById('eName').value = ''; document.getElementById('eAmount').value = '';
    }

    function openEditModal(t, k) {
        const d = t === 'donation' ? localData.donations[k] : localData.expenses[k];
        document.getElementById('editKey').value = k; document.getElementById('editType').value = t;
        document.getElementById('mDate').value = d.date; document.getElementById('mName').value = d.name; document.getElementById('mAmount').value = d.amt;
        document.getElementById('editModal').style.display = 'flex';
    }
    function closeModal() { document.getElementById('editModal').style.display = 'none'; }
    function updateData() {
        const k = document.getElementById('editKey').value, t = document.getElementById('editType').value;
        db.ref((t === 'donation' ? 'donations/' : 'expenses/') + k).update({ date: document.getElementById('mDate').value, name: document.getElementById('mName').value, amt: Number(document.getElementById('mAmount').value), year: new Date(document.getElementById('mDate').value).getFullYear() });
        closeModal();
    }
    function deleteEntry(p, k) { if(confirm("Delete?")) db.ref(p + '/' + k).remove(); }

    function printReceipt(key) {
        const item = localData.donations[key];
        const words = numToWords(item.amt);
        document.getElementById('printArea').innerHTML = `
            <div style="width:210mm; padding:45px; border:15px double #000; background:white; color:black; font-family:'Outfit'; margin:auto; box-sizing:border-box; position:relative; overflow:hidden;">
                <center>
                    <h1 style="font-family:'Cinzel'; font-size:42px; margin:0;">52nd SAHID DIWAS 2026</h1>
                    <h2 style="font-family:'Cinzel'; font-size:24px; margin:5px 0; color:#444;">B.B.C MARANG BUNDU</h2>
                    <p style="font-weight:bold; font-size:14px; margin:0;">Reg.no :- MBJ8750 - 13 Of 2022</p>
                    <div style="background:black; color:white; padding:15px 80px; font-size:26px; font-weight:900; margin-top:20px; letter-spacing:4px; display:inline-block; -webkit-print-color-adjust: exact;">DONATION RECEIPT</div>
                </center>
                <div style="display:flex; justify-content:space-between; font-size:20px; margin-top:35px; border-bottom:1px solid #ddd; padding-bottom:10px;">
                    <span>Receipt No: <b>#${key.substr(-5).toUpperCase()}</b></span>
                    <span>Date: <b>${item.date}</b></span>
                </div>
                <div style="font-size:24px; line-height:2.6; font-family:'Crimson Text'; margin-top:40px;">
                    Received with heartful thanks from Mr./Ms. <span style="font-weight:900; border-bottom:2px solid #000; text-transform:uppercase; padding:0 10px;">${item.name}</span> <br>
                    the sum of Rupees <span style="font-weight:900; border-bottom:2px solid #000; text-transform:capitalize; padding:0 10px;">${words}</span> <br>
                    towards <b style="font-family:'Cinzel'; font-size:18px;">52nd Sahid Diwas Celebration Fund</b>.
                </div>
                <div style="font-size:55px; font-weight:900; border:10px double #000; padding:15px 65px; width:fit-content; margin:45px auto; background:#f5f5f5; letter-spacing:2px; -webkit-print-color-adjust: exact;">‚Çπ ${Number(item.amt).toLocaleString()} /-</div>
                <div style="text-align:center; margin-top:20px; border-top:1px dashed #777; padding-top:20px;">
                    <p style="font-style:italic; font-size:20px; color:#333; line-height:1.4;">"Your generous contribution serves as a noble pillar for the 52nd Sahid Diwas. <br> We honor your spirit of giving."</p>
                    <p style="font-family:'Dancing Script'; font-size:38px; font-weight:bold; margin-top:15px; color:#000;">Thank You!</p>
                </div>
                <div style="display:flex; justify-content:flex-end; margin-top:40px;">
                    <div style="text-align:center;">
                        <span style="font-family:'Dancing Script'; font-size:32px; display:block; height:35px;">${localData.config.tName}</span>
                        <div style="border-top:2.5px solid #000; font-weight:900; width:260px; font-size:13px; padding-top:5px; text-transform:uppercase; letter-spacing:1px;">Principal Treasurer</div>
                    </div>
                </div>
            </div>`;
        window.print();
    }

    function printCertificate(key) {
        const item = localData.donations[key];
        document.getElementById('printArea').innerHTML = `
            <div style="width:210mm; height:297mm; padding:30px; background:#fff; position:relative; box-sizing:border-box; font-family:'Outfit';">
                <div style="border: 15px solid transparent; border-image: url('https://img.freepik.com/free-vector/vintage-ornamental-frame-design_52683-39835.jpg') 30 stretch; height: 100%; padding: 40px; box-sizing: border-box; text-align: center; border-style: solid;">
                    
                    <h2 style="font-family:'Cinzel'; font-size:35px; margin:0; color:#000;">52nd SAHID DIWAS 2026</h2>
                    <h3 style="font-family:'Cinzel'; font-size:22px; margin:5px 0; color:#b45309;">B.B.C MARANG BUNDU</h3>
                    <p style="font-weight:bold; font-size:14px; margin:0;">Reg.no :- MBJ8750 - 13 Of 2022</p>

                    <div style="margin-top:50px;">
                        <h1 style="font-family:'Cinzel'; font-size:60px; color:#b45309; margin:0; letter-spacing:8px;">CERTIFICATE</h1>
                        <h4 style="font-family:'Outfit'; font-size:24px; letter-spacing:4px; margin:10px 0; font-weight:300;">OF APPRECIATION</h4>
                    </div>

                    <p style="font-size:20px; font-family:'Crimson Text'; font-style:italic; margin-top:40px;">This certificate is proudly presented to</p>
                    
                    <h2 style="font-family:'Dancing Script'; font-size:55px; border-bottom:2px solid #b45309; display:inline-block; padding:0 40px; margin:15px 0; color:#1e293b;">${item.name}</h2>

                    <p style="font-size:21px; line-height:1.9; max-width:680px; margin:40px auto; color:#333; font-family:'Crimson Text'; font-style: italic;">
                        "Heroes never die as long as there are hearts like yours to remember them. <br>
                        Your noble contribution towards the <b>52nd SAHID DIWAS 2026</b> is more than a gift; 
                        it is a salute to our <b>Martyrs</b>. By standing with <b>B.B.C MARANG BUNDU</b>, 
                        you have helped us keep their sacred flame alive and <b>Strengthened</b> the soul of our community."
                    </p>

                    <div style="display:flex; justify-content:space-between; margin-top:80px; padding: 0 50px;">
                        <div style="text-align:center;">
                            <div style="height:40px;"></div>
                            <div style="border-top:2px solid #000; width:220px; padding-top:10px; font-weight:900; font-size:14px; text-transform:uppercase;">Secretary</div>
                        </div>
                        <div style="text-align:center;">
                            <div style="font-family:'Dancing Script'; font-size:30px; height:40px;">${localData.config.tName}</div>
                            <div style="border-top:2px solid #000; width:220px; padding-top:10px; font-weight:900; font-size:14px; text-transform:uppercase;">Principal Treasurer</div>
                        </div>
                    </div>

                    <div style="position:absolute; bottom:60px; width:100%; left:0; font-size:11px; opacity:0.6; letter-spacing:2px; font-weight:bold;">
                        B.B.C MARANG BUNDU | TREASURE BOOKS ELITE
                    </div>
                </div>
            </div>`;
        window.print();
    }

    function printReport(type) {
        const fy = document.getElementById('yearFilter').value;
        const data = type === 'don' ? localData.donations : localData.expenses;
        const title = type === 'don' ? 'COLLECTION LEDGER' : 'EXPENDITURE LEDGER';
        let tin = 0, tout = 0;
        Object.values(localData.donations).filter(x => x.year == fy).forEach(x => tin += Number(x.amt));
        Object.values(localData.expenses).filter(x => x.year == fy).forEach(x => tout += Number(x.amt));
        let rows = Object.values(data).filter(x => x.year == fy).sort((a,b)=>new Date(a.date)-new Date(b.date)).map((x, i) => 
            `<tr><td style="border:1px solid #000; padding:10px;">${i+1}</td><td style="border:1px solid #000; padding:10px;">${x.date}</td><td style="border:1px solid #000; padding:10px; text-transform:uppercase;">${x.name}</td><td style="border:1px solid #000; padding:10px;">‚Çπ ${Number(x.amt).toLocaleString()}</td></tr>`
        ).join('');
        document.getElementById('printArea').innerHTML = `
            <div style="padding:50px; background:white; color:black; font-family:'Outfit';">
                <center>
                    <h1 style="font-family:'Cinzel'; font-size:40px; margin:0;">52nd SAHID DIWAS 2026</h1>
                    <h2 style="font-family:'Cinzel'; font-size:24px; margin:5px 0;">B.B.C MARANG BUNDU</h2>
                    <p style="font-weight:bold; font-size:15px;">Reg.no :- MBJ8750 - 13 Of 2022</p>
                    <div style="background:black; color:white; padding:18px; margin-top:20px; font-size:26px; font-weight:900; letter-spacing:4px; -webkit-print-color-adjust: exact;">${title} (${fy})</div>
                </center>
                <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap:15px; margin:30px 0; border:3px solid #000; background:#f2f2f2; padding:20px; text-align:center; -webkit-print-color-adjust: exact;">
                    <div><b>COLLECTIONS</b><br><span style="font-size:22px; color:green;">‚Çπ ${tin.toLocaleString()}</span></div>
                    <div><b>EXPENDITURES</b><br><span style="font-size:22px; color:red;">‚Çπ ${tout.toLocaleString()}</span></div>
                    <div><b>BALANCE</b><br><span style="font-size:22px; color:blue;">‚Çπ ${(tin-tout).toLocaleString()}</span></div>
                </div>
                <table style="width:100%; border-collapse:collapse; font-size:16px;">
                    <thead><tr style="background:#ddd; -webkit-print-color-adjust: exact;"><th style="border:1px solid #000; padding:12px;">S.N</th><th style="border:1px solid #000; padding:12px;">DATE</th><th style="border:1px solid #000; padding:12px;">PARTICULARS</th><th style="border:1px solid #000; padding:12px;">AMOUNT (‚Çπ)</th></tr></thead>
                    <tbody>${rows}</tbody>
                </table>
                <div style="display:flex; justify-content:space-between; margin-top:100px;">
                    <div style="text-align:center;"><span style="font-family:'Dancing Script'; font-size:30px;">${localData.config.atName}</span><div style="border-top:2.5px solid #000; width:220px; padding-top:5px; font-weight:bold;">ASSISTANT TREASURER</div></div>
                    <div style="text-align:center;"><span style="font-family:'Dancing Script'; font-size:30px;">${localData.config.tName}</span><div style="border-top:2.5px solid #000; width:220px; padding-top:5px; font-weight:bold;">PRINCIPAL TREASURER</div></div>
                </div>
            </div>`;
        window.print();
    }

    (function init() {
        const s = document.getElementById('yearFilter');
        for (let y = 2026; y <= 2050; y++) {
            let o = document.createElement('option'); o.value = y; o.text = "" + y;
            if(y === 2026) o.selected = true; s.appendChild(o);
        }
        document.getElementById('eDate').valueAsDate = new Date();
    })();
</script>
</body>
</html>
